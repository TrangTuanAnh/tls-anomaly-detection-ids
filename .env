# Database (MySQL)
MYSQL_ROOT_PASSWORD=1234
MYSQL_DATABASE=tls_ids
MYSQL_USER=tls_user
MYSQL_PASSWORD=1234

# Ingest signing (python-real-time-service -> backend)
# Nếu muốn đơn giản (không ký/không verify):
#   REQUIRE_INGEST_HMAC=false
#   INGEST_HMAC_SECRET=
# Nếu muốn bật ký + verify (khuyến nghị khi demo):
#   REQUIRE_INGEST_HMAC=true
#   INGEST_HMAC_SECRET=<chuỗi_bí_mật_bất_kỳ>
REQUIRE_INGEST_HMAC=false
INGEST_HMAC_SECRET=
INGEST_HMAC_MAX_AGE_SEC=120


# Auto-block + Firewall action signing (backend -> firewall-controller)
# AUTO_BLOCK_ENABLED: backend tự tạo record BLOCK khi severity HIGH/CRITICAL
# FIREWALL_TARGET: hiện chỉ hỗ trợ "iptables"
AUTO_BLOCK_ENABLED=true
FIREWALL_TARGET=iptables

# QUAN TRỌNG: backend và firewall-controller phải cùng secret này
FW_ACTION_HMAC_SECRET=2b9d1d2d6a0e4b5ab1f9c0d6a7b8c9d0

# Backend set expires_at cho action (seconds)
FW_ACTION_EXPIRES_SEC=3600

# Firewall-controller: signature max age (seconds)
FW_ACTION_MAX_AGE_SEC=86400

# Cho phép action không ký (KHÔNG KHUYẾN NGHỊ)
ALLOW_UNSIGNED_FW_ACTIONS=false

# firewall-controller tuning
FW_DRY_RUN=false
FW_POLL_INTERVAL=1.0

# Reconcile: phát hiện rule DROP bị thêm ngoài hệ thống
FW_RECONCILE_INTERVAL_SEC=60
FW_RECONCILE_REMOVE_UNKNOWN=false

# Chain mặc định khi demo cùng Docker
# - Nếu chạy theo mode firewall riêng (docker-compose.firewall.yml) thường dùng FORWARD
# - Nếu demo chặn container Docker nên dùng DOCKER-USER
IPTABLES_CHAIN=DOCKER-USER

# Optional: Model integrity checks (python-real-time-service)
# Nếu muốn khóa file model/scaler theo hash:
# AE_MODEL_SHA256=<sha256 của trained_models/autoencoder_tls.h5>
# SCALER_SHA256=<sha256 của scaler.pkl>
AE_MODEL_SHA256=391fd02d9d0566c1b4c28efcde05a2c7a970355366a7ae86fc1fa5b149e84407
SCALER_SHA256=0f30f568658e6d04f760130d82c6948023d2f59e5b1d71101e8a6d7bf2929941

# Optional: override scaler path (nếu đổi tên/đặt chỗ khác)
SCALER_PATH=
