# =====================
# Database (MySQL)
# =====================
MYSQL_ROOT_PASSWORD=1234
MYSQL_DATABASE=tls_ids
MYSQL_USER=tls_user
MYSQL_PASSWORD=1234

# Port publish của MySQL ra host (firewall-controller dùng host network sẽ connect vào đây)
# Nếu máy đã có MySQL hoặc port 3306 bận, đổi sang 3307 (và giữ nguyên DB_PORT trong backend).
MYSQL_HOST_PORT=3306

# =====================
# Backend security 
# =====================
# Backend dùng cái này để ký token đăng nhập (BẮT BUỘC)
SESSION_HMAC_SECRET=feaae113eb4a85b7b0e5ed044bb73d36d7fe085953654a4d9e05e94ce6262408

# Token expire (backend có đọc)
ACCESS_TOKEN_EXPIRE_MINUTES=60

# Default admin (seeded on first run)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=Admin1234
ADMIN_FULL_NAME=Default Admin

# (Optional) Hardening admin requests (UI -> backend)
REQUIRE_ADMIN_HMAC=false
ADMIN_HMAC_SECRET=7f2c1c8dfb2f44779c8f1cc2b9d5f5d1
ADMIN_HMAC_MAX_AGE_SEC=120

# (Optional) Hardening ingest path (python-realtime -> backend)
REQUIRE_INGEST_HMAC=false
INGEST_HMAC_SECRET=4c8f3f5b2e3a4d4a9b6d1a2c3e4f5678
INGEST_HMAC_MAX_AGE_SEC=120

# Firewall action signing (backend -> firewall-controller)
# QUAN TRỌNG: backend và firewall-controller phải cùng secret này
FW_ACTION_HMAC_SECRET=2b9d1d2d6a0e4b5ab1f9c0d6a7b8c9d0
FW_ACTION_EXPIRES_SEC=3600
FW_ACTION_MAX_AGE_SEC=86400
ALLOW_UNSIGNED_FW_ACTIONS=false

# =====================
# Optional flags
# =====================
AUTO_BLOCK_ENABLED=true
FIREWALL_TARGET=iptables

# (Optional) firewall-controller tuning (không bắt buộc)
FW_DRY_RUN=false
FW_POLL_INTERVAL=1.0
FW_RECONCILE_INTERVAL_SEC=60
FW_RECONCILE_REMOVE_UNKNOWN=false
IPTABLES_CHAIN=DOCKER-USER
