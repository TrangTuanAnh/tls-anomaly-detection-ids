# Database (MySQL)
# NOTE: đổi các mật khẩu này trước khi demo/triển khai thật.
MYSQL_ROOT_PASSWORD=change_me
MYSQL_DATABASE=tls_ids
MYSQL_USER=tls_user
MYSQL_PASSWORD=change_me

# Firewall controller default creds (nếu bạn dùng docker-compose.firewall.yml)
# Mặc định dùng chung user với backend để demo đơn giản.
FW_DB_USER=tls_user
FW_DB_PASSWORD=change_me
FW_DB_NAME=tls_ids

# Traffic capture (NFStream)
# Chọn interface đúng với máy bạn (vd: eth0 / ens33 / wlan0)
# Default để eth0 để đỡ fail khi chạy trên máy khác.
CAPTURE_INTERFACE=eth0
# Output mode for sniffer
#  - url: POST flows to python-real-time-service (/flow)  (khuyến nghị realtime)
#  - csv: ghi ra file CSV (debug)
CIC_OUTPUT_MODE=url

# Flow split timeouts (seconds) - tune if you want shorter/longer flows
IDLE_TIMEOUT=10
ACTIVE_TIMEOUT=300

# Ingest signing (python-real-time-service -> backend)
# Nếu muốn đơn giản (không ký/không verify):
#   REQUIRE_INGEST_HMAC=false
#   INGEST_HMAC_SECRET=
# Nếu muốn bật ký + verify (khuyến nghị khi demo):
#   REQUIRE_INGEST_HMAC=true
#   INGEST_HMAC_SECRET=<chuỗi_bí_mật_bất_kỳ>
REQUIRE_INGEST_HMAC=false
INGEST_HMAC_SECRET=
INGEST_HMAC_MAX_AGE_SEC=120

# Auto-block -> ghi firewall_actions khi phát hiện bất thường
AUTO_BLOCK=true

# Thresholds (tuỳ mô hình)
# MLP classifier output là sigmoid (0..1). Threshold mặc định: 0.5
MLP_THRESHOLD=0.5
# Backward-compatible biến cũ
AE_THRESHOLD=0.5
ISO_THRESHOLD=-0.1

# Optional: Model integrity checks (python-real-time-service)
# Nếu muốn khóa file model/scaler theo hash:
# MLP_MODEL_SHA256=<sha256 của mlp.h5>
# SCALER_SHA256=<sha256 của scaler.pkl>
MLP_MODEL_SHA256=
# Backward-compatible biến cũ
AE_MODEL_SHA256=
SCALER_SHA256=

# Optional: override model paths
MLP_MODEL_PATH=/app/trained_models/mlp.h5
# Backward-compatible biến cũ
AE_MODEL_PATH=/app/trained_models/mlp.h5
SCALER_PATH=/app/trained_models/scaler.pkl
ISO_MODEL_PATH=

# Firewall host (docker-compose.firewall.yml)
# (đặt IP/hostname của sensor machine nơi MySQL được publish)
FW_DB_HOST=127.0.0.1

# Optional: name this sensor (ghi vào DB)
SENSOR_NAME=sensor-1

# ---------------- Docker networking (sensor machine) ----------------
# Mục tiêu: các service nội bộ (backend, python-real-time-service) chỉ giao tiếp
# qua Docker network. Chỉ MySQL publish ra ngoài để firewall-controller connect.

# Subnet nội bộ cho sensor docker network (đổi nếu bị trùng dải mạng trên máy bạn)
SENSOR_NET_SUBNET=172.30.0.0/24

# Static IP trong sensor_net (đồng bộ với docker-compose.sensor.yml)
MYSQL_IP=172.30.0.10
BACKEND_IP=172.30.0.20
RT_IP=172.30.0.30

# Public exposure: chỉ MySQL
MYSQL_PUBLIC_BIND=0.0.0.0
MYSQL_PUBLIC_PORT=3306

# Nếu bạn đổi RT_IP hoặc subnet, nhớ update FLOW_URL cho nfstream (host-mode)
# FLOW_URL=http://172.30.0.30:9000/flow
