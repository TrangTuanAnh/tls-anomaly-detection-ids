%YAML 1.1
---
##############################################
#  SURICATA - LITE TLS CONFIG FOR YOUR LAB   #
#  Logs TLS (JA3/JA3S) into D:\...           #
##############################################

suricata-version: "8.0"

##############################################
# 1. NETWORK VARS
##############################################
vars:
  address-groups:
    HOME_NET: "any"
    EXTERNAL_NET: "any"

##############################################
# 2. LOG DIRECTORY (WSL → Ổ D:)
##############################################
# Thư mục này PHẢI tồn tại trong WSL:
# /mnt/d/Newdoan/Project_Cryptography/module-tls/logs
default-log-dir: /mnt/d/Newdoan/Project_Cryptography/module-tls/logs

##############################################
# 3. OUTPUTS (EVE.JSON + TLS)
##############################################
outputs:
  - eve-log:
      enabled: yes
      filetype: regular
      filename: eve.json
      buffer-size: 0 # flush ngay để realtime
      threaded: no # tránh đụng độ khi ghi vào NTFS
      metadata: yes
      types:
        - tls:
            extended: yes
            # log thêm fingerprint TLS để model dùng
            custom: [sni, version, ja3, ja3s]
        - stats:
            totals: yes
            threads: no

##############################################
# 4. LOGGING (SURICATA LOG RA CONSOLE + FILE)
##############################################
logging:
  default-log-level: info
  outputs:
    - console:
        enabled: yes
    - file:
        enabled: yes
        filename: suricata.log

##############################################
# 5. CAPTURE (WSL THƯỜNG DÙNG eth0)
##############################################
af-packet:
  - interface: eth0
    cluster-id: 99
    cluster-type: cluster_flow
    defrag: yes
  - interface: default

##############################################
# 6. APP-LAYER – BẬT TLS + DNS + HTTP
##############################################
app-layer:
  protocols:
    tls:
      enabled: yes
      detection-ports:
        dp: 443
      ja3-fingerprints: yes
      ja4-fingerprints: yes

    http:
      enabled: yes

    dns:
      udp:
        enabled: yes
        detection-ports:
          dp: 53
      tcp:
        enabled: yes
        detection-ports:
          dp: 53

##############################################
# 7. BASIC FLOW / STREAM SETTINGS
##############################################
flow:
  memcap: 64 MiB

stream:
  memcap: 64 MiB
  reassembly:
    memcap: 128 MiB
    depth: 1 MiB

##############################################
# 8. THREADING
##############################################
threading:
  set-cpu-affinity: no
  detect-thread-ratio: 1.0

##############################################
# 9. DETECTION RULES (TẠM THỜI KHÔNG DÙNG)
##############################################
default-rule-path: /var/lib/suricata/rules

# Để rỗng cho đỡ lỗi rule:
rule-files: []
